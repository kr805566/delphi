SELECT ROOM.RMNO
	
			FROM ROOM
			LEFT  JOIN ARRANGE ON ROOM.RMNO = ARRANGE.RMNO
			RIGHT  JOIN ORDERS
			INNER JOIN ORDERS_D ON ORDERS.ODID = ORDERS_D.ODID ON ARRANGE.OBNO = ORDERS_D.OBNO
			WHERE
RMARRDATE  =''

AND

ROOM.RMNO
NOT
IN
(SELECT ROOM.RMNO
	
			FROM ROOM
			LEFT  JOIN ARRANGE ON ROOM.RMNO = ARRANGE.RMNO
			RIGHT  JOIN ORDERS
			INNER JOIN ORDERS_D ON ORDERS.ODID = ORDERS_D.ODID ON ARRANGE.OBNO = ORDERS_D.OBNO
			WHERE

'106/11/01' >= SUBSTRING(OBARRDATE, 1, 9)
			AND '106/11/01' < SUBSTRING(OBDEPDATE, 1, 9)
AND ORDERS.ODSTAT IN ('3', '5'))






GROUP BY ROOM.RMNO

ORDER BY ROOM.RMNO

